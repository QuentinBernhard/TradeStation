Inputs:		P1((4*C+H+L)/6),			L1(5),			Length(125),			stdDevLength(150),			stdDevFactor(1),			StopColor1(red),			SignalColor(white),			volLength(15);			Vars:		ma(0),				maa1(0),			maa2(0),			maa(0),			Li(0),				Le(0),			upperEnvelopeLine(0),			lowerEnvelopeLine(0),			upperEnvelopeLine1(0),			lowerEnvelopeLine1(0),			bullPower(0),			bearPower(0),			maxPower(0),			percentPenetration(0),			stdDevToUse(0),			count(0),			N(0),			N1(0),			N2(0),			N3(0),			M(0),			M1(0),			M2(0),			M3(0),			HH(0),			LL(0),			Dimen(0),			alpha(0),			FiltLi(0),			FiltLe(0),			dernier_indice(0),			dernier("bearish"), 			ind(0),			xAv(0),			j(0),			short_prise(False), 			long_prise(False),			nbreshares(1),			somme(0);Le = L1;Li=2;N=Li;M=Le;N3 = (Highest(High, N) - Lowest(Low, N)) / N;HH = High;LL = Low;For count = 0 to N / 2 - 1 begin	If High[count] > HH then HH = High[count];	If Low[count] < LL then LL = Low[count];End;N1 = (HH - LL) / (N / 2);HH = High[N / 2];LL = Low[N / 2];For count = N/2 to N - 1 begin	If High[count] > HH then HH = High[count];	If Low[count] < LL then LL = Low[count];End;N2 = (HH - LL) / (N / 2);If N1 > 0 and  N2 > 0 and N3 > 0 then Dimen = (Log(N1 + N2) - Log(N3)) / Log(2);alpha = ExpValue(-4.6*(Dimen - 1));If alpha < .01 then alpha = .01;If alpha > 1 then alpha = 1;FiltLi = alpha*P1  + (1 - alpha)*FiltLi[1];If CurrentBar < N + 1 then FiltLi = P1 ;M3 = (Highest(High, M) - Lowest(Low, M)) / M;For count = 0 to M / 2 - 1 begin	If High[count] > HH then HH = High[count];	If Low[count] < LL then LL = Low[count];End;M1 = (HH - LL) / (M / 2);HH = High[M / 2];LL = Low[M / 2];For count = M/2 to M - 1 begin	If High[count] > HH then HH = High[count];	If Low[count] < LL then LL = Low[count];End;N2 = (HH - LL) / (M / 2);If M1 > 0 and  M2 > 0 and M3 > 0 then Dimen = (Log(M1 + M2) - Log(M3)) / Log(2);alpha = ExpValue(-4.6*(Dimen - 1));If alpha < .01 then alpha = .01;If alpha > 1 then alpha = 1;FiltLe = alpha*P1  + (1 - alpha)*FiltLe[1];If CurrentBar < M + 1 then FiltLe = P1 ;maa1 = (AdaptiveMovAvg( P1 ,Li, Li, Li)+ 2*filtLi)/3;maa2 = (AdaptiveMovAvg( P1 ,Le, Le, Le)+ 2*filtLe)/3;ma = AdaptiveMovAvg((maa1+maa2)/2,Le,Le,Le);if ma > 0 then begin									//xaverage et adaptativemovavg sont lin√©aires	bullPower = absValue(high-ma);	bearPower = absValue(low-ma);	maxPower = maxList(bullPower, bearPower);	percentPenetration = maxPower / ma;	stdDevToUse = xaverage(stdDevS(percentPenetration, stdDevLength),stdDevLength);	upperEnvelopeLine = xaverage(ma* (1+(stdDevFactor*stdDevToUse)),Le);	lowerEnvelopeLine = xaverage(ma* (1-(stdDevFactor*stdDevToUse)),Le);	upperEnvelopeLine1 = xaverage(ma* (1+(stdDevFactor/4*stdDevToUse)),Le);	lowerEnvelopeLine1 = xaverage(ma* (1-(stdDevFactor/4*stdDevToUse)),Le);			if  P1<=lowerEnvelopeLine then begin 		dernier = "bearish";	end;		if  P1>upperEnvelopeLine then begin  		dernier = "bullish";	end;		dernier_indice = 0;	if P1>lowerEnvelopeLine and P1<=upperEnvelopeLine then Begin		while P1[dernier_indice] > lowerEnvelopeLine[dernier_indice] and P1[dernier_indice] <= upperEnvelopeLine[dernier_indice] Begin			dernier_indice  = dernier_indice + 1;			if P1[dernier_indice] <= lowerEnvelopeLine[dernier_indice] Then				dernier = "bearish";			if P1[dernier_indice] > upperEnvelopeLine[dernier_indice] Then				dernier = "bullish";		end;	end;	end;somme = 0;for ind = 0 To volLength Begin	if dernier[ind] = "bearish" then Begin		if Close[ind] > lowerEnvelopeLine[ind] and close[ind] < upperEnvelopeLine[1 + ind] Then			somme = somme + 1;	end;	if dernier[ind] = "bullish" then Begin		if Close[ind] > lowerEnvelopeLine[1 + ind] and close[ind] < upperEnvelopeLine[ind] Then			somme = somme + 1;	end;end;plot1(somme);